<h2>Агенты администрируемых серверов</h2>

<div id="cmdbar" class="ui float right">
    <a asp-action="add">Добавить</a>
</div>

<div class="ui tiny modal">
  <div class="header">Header</div>
  <div class="content">
    <p>Удалить?</p>
  </div>
  <div class="actions">
    <a class="ui approve button">Да</a>
    <a class="ui cancel button">Нет</a>
  </div>
  <form id="poster" method="POST" action="">
  </form>
</div>

<div class="ui divided items">
    @foreach(var row in Model) {
      <div class="item">
        <div class="image"><i class="laptop massive icon"></i></div>
        <div class="content">
            <a class="header" asp-action="overview" asp-controller="cluster">@row.Идентификатор</a>
            <div class="meta">
                <span>Сетевое имя: @row.СетевоеИмя</span>
                <span>Порт: @row.Порт</span>
            </div>
            <div class="extra" id="agnt-@row.Идентификатор">
                <div class="ui dropdown">
                    <div class="text">Действия</div>
                    <div class="menu">
                        <div class="item">
                            <a asp-action="edit" asp-route-id="@row.Идентификатор"><i class="edit icon"></i>Редактировать</a>
                        </div>
                        <div class="item">
                            <a><i class="remove icon"></i>Удалить</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      </div>
    }
</div>

<script>
    $('a.delete').click(function(evnt){
        evnt.preventDefault();
        var dialog = $('.modal')
        var myId = this.id.substr(3);
        dialog.find('div.content > p').text('Удалить элемент ' + myId + '?');
        dialog.find('div.actions > a.approve').click(function(){
            $('#poster').submit();
        });
        $('#poster').attr('action', '/agents/delete/'+myId);
        
        dialog.modal('show');
    });
</script>
